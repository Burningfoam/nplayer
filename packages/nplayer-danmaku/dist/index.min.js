!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("NPlayerDanmaku",[],e):"object"==typeof exports?exports.NPlayerDanmaku=e():t.NPlayerDanmaku=e()}(this,(function(){return function(){var t={498:function(t,e,n){"use strict";n.r(e);var i=n(645),s=n.n(i)()((function(t){return t[1]}));s.push([t.id,".nplayer_danmaku_screen{bottom:0;left:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0}.nplayer_danmaku_send{align-items:center;background:hsla(0,0%,100%,.15);display:flex;flex:1;font-size:0;margin:0 10px!important}.nplayer_danmaku_send input{background:transparent;border:0;color:currentColor;flex:1;outline:0;padding:0;width:100px}.nplayer_danmaku_send input::-moz-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input:-ms-input-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input::placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send_btn{cursor:pointer;font-size:12px;padding:0 10px;white-space:nowrap}.nplayer_danmaku_send .nplayer_popover_panel{font-size:13px;padding:0 15px}.nplayer_danmaku_send .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_send .nplayer_checkbox+.nplayer_checkbox{margin-left:10px}.nplayer_danmaku_colors{align-items:center;display:flex;flex-wrap:wrap;padding-bottom:12px}.nplayer_danmaku_color{height:19px;margin-bottom:5px;margin-right:5px;width:19px}.nplayer_danmaku_color_row{align-items:stretch;display:flex;margin:5px 0}.nplayer_danmaku_color_row input{border:1px solid hsla(0,0%,100%,.8);flex:3;letter-spacing:1px;padding:0 5px;width:0}.nplayer_danmaku_color_preview{flex:2;height:20px;margin-left:5px}.nplayer_danmaku_color:hover{transform:scale(1.1)}.nplayer_danmaku_row{justify-content:space-between;margin:12px 0}.nplayer_danmaku_onoff_label{margin-right:5px;margin-top:-2px}.nplayer_danmaku_reset{border:1px solid hsla(0,0%,100%,.5);margin-left:auto;padding:2px 5px;transition:opacity .2s ease}.nplayer_danmaku_reset:hover{opacity:.7}.nplayer_danmaku_setting{font-size:13px;padding:10px 20px}.nplayer_danmaku_setting .nplayer_slider{margin:3px 12px}.nplayer_danmaku_setting .nplayer_checkbox{margin-top:5px}.nplayer_danmaku_setting .nplayer_checkbox+.nplayer_checkbox{margin-left:15px}.nplayer_danmaku_item{color:#fff;letter-spacing:1px;line-height:1.125;position:absolute;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px;white-space:nowrap;will-change:transform}.nplayer_danmaku_item-center{left:50%;transform:translateX(-50%);will-change:auto;z-index:1}.nplayer_danmaku_item-me{outline:2px solid;z-index:2}",""]),e.default=s},645:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var s={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(s[a]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);i&&s[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},132:function(t,e,n){var i;"undefined"!=typeof window&&window.document&&function(){var t=n(498);t.__esModule&&(t=t.default);var e="string"==typeof t?t:t[0][1],s=!1;i||((i=document.createElement("style")).setAttribute("type","text/css"),s=!0),"textContent"in i?i.textContent=e:i.styleSheet.cssText=e,s&&document.head.appendChild(i)}()}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return function(){"use strict";n.d(i,{default:function(){return J}});var t;n(132);function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return!t||"string"==typeof t&&("#fff"===(t=t.toLowerCase())||"#ffffff"===t)}var o="nplayer:danmaku";var a="Send settings",r="Send",l="Mode",p="Scroll",u="Top",h="Bottom",c="Color",d="Color",f="Danmaku settings",m="On/Off",y="Restore settings",v="Block by type",k="Opacity &nbsp;",b="Area &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",g="Half",_="Full",w="Speed &nbsp;&nbsp;&nbsp;",x="Slow",C="Fast",S="Font size",E="Small",T="Unlimited",P="Bottom to top",B=(e(t={},a,"发送设置"),e(t,r,"发送"),e(t,l,"模式"),e(t,p,"滚动"),e(t,u,"顶部"),e(t,h,"底部"),e(t,c,"颜色"),e(t,d,"彩色"),e(t,f,"弹幕设置"),e(t,m,"开/关"),e(t,y,"恢复默认设置"),e(t,v,"按类型屏蔽"),e(t,k,"不透明度"),e(t,b,"显示区域"),e(t,g,"半屏"),e(t,_,"全屏"),e(t,w,"弹幕速度"),e(t,x,"慢"),e(t,C,"快"),e(t,S,"字体大小"),e(t,E,"小"),e(t,"Big","大"),e(t,T,"不限弹幕"),e(t,P,"从下到上"),t),O={DANMAKU_SEND:"DanmakuSend",DANMAKU_UPDATE_OPTIONS:"DanmakuUpdateOptions"};function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var D="nplayer_danmaku_item",I=function(){function t(e,n,i,s){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.danmaku=n,this.width=0,this.left=0,this.length=0,this.startAt=0,this.showAt=0,this.endAt=0,this.speed=0,this.track=0,this.ended=!1,this.color="",this.end=function(){o.el.removeEventListener("transitionend",o.end),clearTimeout(o.centerTimer),o.el.style.cssText="",o.color="",o.el.className=D,o.ended=!0,o.hide(),o.danmaku.recycleBullet(o)},this.el=e.appendChild(document.createElement("div")),this.el.className=D,this.init(i,s)}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){this.el.textContent=t.text,this.type=t.type||"scroll",this.track=e.track,t.color&&(this.el.style.color=this.color=t.color),t.isMe&&this.el.classList.add("nplayer_danmaku_item-me");var n=this.el.style;if(n.fontSize="".concat(this.danmaku.fontsize,"px"),this.startAt=this.danmaku.timer.now(),"scroll"===this.type){this.el.addEventListener("transitionend",this.end),this.width=this.el.getBoundingClientRect().width+20;var i=this.danmaku.width,s=e.prev;if(this.left=i,this.speed=this.danmaku.speedScale*(i+this.width)/this.danmaku.opts.duration,s&&!s.ended){var o=s.length-i-(this.startAt-s.startAt)*s.speed;if(o>=0)this.speed=s.speed,this.left+=o;else{var a=this.danmaku.width/(s.endAt-this.startAt);this.speed>a&&(this.speed=a)}}this.length=this.left+this.width;var r=this.length/this.speed;this.showAt=this.startAt+(this.length-i)/this.speed,this.endAt=this.startAt+r,this.updateScrollY(),n.left="".concat(this.left,"px"),n.transition="transform ".concat(r,"s linear"),n.transform="translate3d(-".concat(this.length,"px,0,0)")}else{n[this.type]=this.pos(),this.el.classList.add("nplayer_danmaku_item-center");var l=this.danmaku.speedScale*this.danmaku.opts.duration;this.endAt=this.startAt+l,this.centerTimer=setTimeout(this.end,1e3*l)}return this.ended=!1,this.show(),this.danmaku.paused&&this.pause(this.startAt),this}},{key:"pos",value:function(){return"".concat(this.track*this.danmaku.trackHeight+2,"px")}},{key:"updateScrollY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.danmaku.opts.bottomUp;if("scroll"===this.type){var e=this.el.style;e.top=e.bottom="",e[t?"bottom":"top"]=this.pos()}}},{key:"show",value:function(){this.el.style.visibility=""}},{key:"hide",value:function(){this.el.style.visibility="hidden"}},{key:"pause",value:function(t){if("scroll"===this.type){var e=this.el.style;e.transition="transform 0s linear",e.transform="translate3d(-".concat((t-this.startAt)*this.speed,"px,0,0)")}else clearTimeout(this.centerTimer)}},{key:"run",value:function(t){if("scroll"===this.type){var e=this.el.style;e.transition="transform ".concat(this.endAt-t,"s linear"),e.transform="translate3d(-".concat(this.length,"px,0,0)")}else this.centerTimer=setTimeout(this.end,1e3*(this.endAt-t))}}])&&A(e.prototype,n),i&&A(e,i),t}();function z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==n)return;var i,s,o=[],a=!0,r=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){r=!0,s=t}finally{try{a||null==n.return||n.return()}finally{if(r)throw s}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){U(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function U(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var L,H=function(){return{disable:!1,blocked:[],fontsize:24,fontsizeScale:1,opacity:1,speed:1,area:.5,unlimited:!1,bottomUp:!1,colors:["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#CC0273","#222222","#FFFFFF"],duration:5,items:[],zIndex:5,persistOptions:!1,isDefaultColor:s,maxPerInsert:20,poolSize:50,discard:function(){return!1}}},K=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e,this._opts=n,this.enabled=!1,this.paused=!1,this.track=0,this.trackHeight=0,this.bulletPool=[],this.aliveBullets=new Set,this.scrollBullets=[],this.topBullets=[],this.bottomBullets=[],this.items=[],this.pos=0,this.prevPauseTime=0,this.fire=function(){if(i.enabled&&i.player.playing){i.paused&&i.resume();for(var t,e=i.currentTime,n=i.opts.unlimited?.5:1,s=e-n,o=e+n,a=i.timer.now(),r=i.items.length,l=0,p=i.opts.maxPerInsert;i.pos<r;i.pos++)if(!((t=i.items[i.pos]).time<s)){if(t.time>o)break;if(!i.shouldDiscard(t)){if(!i.insert(t,a))break;if(++l>p)break}}}},this.updateTrack=function(){i.trackHeight=i.fontsize+5,i.track=Math.floor(i.player.rect.height*i.opts.area/i.trackHeight)},this.onSeeked=function(){i.clearScreen(),i.pos=0},this.pause=function(){i.prevPauseTime=i.timer.now(),i.timer.pause(),i.aliveBullets.forEach((function(t){return t.pause(i.prevPauseTime)})),i.paused=!0},this.resume=function(){i.player.playing&&!i.player.loading.isActive&&(i.timer.play(),i.aliveBullets.forEach((function(t){return t.run(i.prevPauseTime)})),i.paused=!1)},this.opts=F(F(F({},H()),function(){try{var t=window.localStorage.getItem(o);if(!t)return;return JSON.parse(t)}catch(t){}}()),n);var s=e.Player.__utils,a=s.$,r=s.addDisposable;this.el=e.el.appendChild(a(".danmaku_screen")),this.el.style.zIndex=String(this.opts.zIndex),this.items=this.opts.items,this.timer={_prevPauseTime:0,_pausedTime:0,_paused:!1,now:function(){return((this._paused?this._prevPauseTime:Date.now())-this._pausedTime)/1e3},play:function(){this._paused&&(this._pausedTime+=Date.now()-this._prevPauseTime,this._paused=!1)},pause:function(){this._paused||(this._prevPauseTime=Date.now(),this._paused=!0)}},this.opts.disable||this.enable(),r(this,e.on(e.EVENT.MOUNTED,this.updateTrack)),r(this,e.on(e.EVENT.UPDATE_SIZE,this.updateTrack)),r(e,this)}var e,n,i;return e=t,(n=[{key:"width",get:function(){return this.player.rect.width}},{key:"currentTime",get:function(){return this.player.currentTime}},{key:"playbackRate",get:function(){return this.player.playbackRate}},{key:"fontsize",get:function(){return this.opts.fontsize*this.opts.fontsizeScale}},{key:"speedScale",get:function(){return this.playbackRate*this.opts.speed}},{key:"createBullet",value:function(t,e){var n=this.bulletPool.pop();return n?n.init(t,e):n=new I(this.el,this,t,e),this.aliveBullets.add(n),n}},{key:"unmountBullet",value:function(t){t.el&&t.el.parentNode&&t.el.parentNode.removeChild(t.el)}},{key:"getShortestTrack",value:function(){var t=this.scrollBullets[0];if(!t||t.ended)return[0];for(var e,n=1;n<this.track;++n){if(!(e=this.scrollBullets[n])||e.ended)return[n];t.showAt>e.showAt&&(t=e)}return[t.track,t]}},{key:"getEmptyTrack",value:function(t,e){for(var n=0;n<this.track;++n)if(!e[n]||e[n]<=t)return n;return-1}},{key:"shouldDiscard",value:function(t){return!(!this.opts.blocked.includes(t.type||"scroll")&&!this.opts.discard(t)&&(!t.color||!this.opts.blocked.includes("color")||this.opts.isDefaultColor(t.color)))}},{key:"storeOptions",value:function(){if(this.player.emit(O.DANMAKU_UPDATE_OPTIONS,this.opts),this.opts.persistOptions){var t=this.opts;!function(t){try{window.localStorage.setItem(o,JSON.stringify(t))}catch(t){}}({blocked:t.blocked,fontsizeScale:t.fontsizeScale,opacity:t.opacity,speed:t.speed,area:t.area,unlimited:t.unlimited,bottomUp:t.bottomUp})}}},{key:"recycleBullet",value:function(t){this.bulletPool.length>this.opts.poolSize?this.unmountBullet(t):this.bulletPool.push(t),this.aliveBullets.delete(t),"scroll"===t.type&&this.scrollBullets[t.track]===t&&(this.scrollBullets[t.track]=void 0)}},{key:"insert",value:function(t,e){if(!t.type||"scroll"===t.type){var n=z(this.getShortestTrack(),2),i=n[0],s=n[1],o=!t.force&&s&&s.showAt>e+2;return!(o&&!this.opts.unlimited||(this.scrollBullets[i]=this.createBullet(t,{track:i,prev:o?void 0:s}),0))}var a="top"===t.type?this.topBullets:this.bottomBullets,r=this.getEmptyTrack(e,a);return-1!==(r=-1===r&&t.force?0:r)&&(a[r]=this.createBullet(t,{track:r}).endAt,!0)}},{key:"send",value:function(t){null==t.time&&(t.time=this.currentTime),t=F({isMe:!0,force:!0},t),this.player.emit(O.DANMAKU_SEND,t);var e=this.addItem(t);this.pos>e&&this.insert(t,this.timer.now())}},{key:"getItems",value:function(){return this.items}},{key:"addItem",value:function(t){if(null==t.time)return-1;for(var e=0,n=0,i=this.items.length;n<i;n++)if(this.items[n].time>t.time){e=n;break}return this.items.splice(e,0,t),e}},{key:"appendItems",value:function(t){this.items=this.items.concat(t)}},{key:"resetItems",value:function(t){this.items=t,this.pos=0}},{key:"updateOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.opts.opacity;this.el.style.opacity=String(t),this.storeOptions()}},{key:"updateFontsize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.opts.fontsizeScale;this.opts.fontsizeScale=t,this.updateTrack(),this.storeOptions()}},{key:"updateArea",value:function(t){[.25,.5,.75,1].includes(t)&&(this.opts.area=t,this.updateTrack(),this.storeOptions())}},{key:"updateUnlimited",value:function(t){this.opts.unlimited=t,this.storeOptions()}},{key:"updateBottomUp",value:function(t){this.opts.bottomUp=t,this.aliveBullets.forEach((function(e){return e.updateScrollY(t)})),this.storeOptions()}},{key:"updateSpeed",value:function(t){this.opts.speed=t,this.storeOptions()}},{key:"blockType",value:function(t){var e=this;this.opts.blocked.includes(t)||(this.opts.blocked.push(t),this.aliveBullets.forEach((function(n){(n.type===t||"color"===t&&!e.opts.isDefaultColor(n.color))&&n.hide()})),this.storeOptions())}},{key:"allowType",value:function(t){var e=this;this.opts.blocked=this.opts.blocked.filter((function(e){return e!==t})),this.aliveBullets.forEach((function(n){(n.type===t||"color"===t&&!e.opts.isDefaultColor(n.color))&&n.show()})),this.storeOptions()}},{key:"resetOptions",value:function(){var t=this;this.opts.blocked.forEach((function(e){t.allowType(e)})),this.opts=F(F({},H()),this._opts),this.opts.blocked=[],this.updateOpacity(),this.updateFontsize(),this.updateBottomUp(this.opts.bottomUp)}},{key:"clearScreen",value:function(){Array.from(this.aliveBullets).forEach((function(t){return t.end()})),this.topBullets=[],this.bottomBullets=[]}},{key:"enable",value:function(){if(!this.enabled){this.enabled=!0;var t=this.player.EVENT;this.player.on(t.TIME_UPDATE,this.fire),this.player.on(t.PAUSE,this.pause),this.player.on(t.ENDED,this.pause),this.player.on(t.PLAY,this.resume),this.player.on(t.SEEKED,this.onSeeked),this.player.on(t.LOADING_SHOW,this.pause),this.player.on(t.LOADING_HIDE,this.resume)}}},{key:"disable",value:function(){this.enabled=!1,this.clearScreen();var t=this.player.EVENT;this.player.off(t.TIME_UPDATE,this.fire),this.player.off(t.PAUSE,this.pause),this.player.off(t.ENDED,this.pause),this.player.off(t.PLAY,this.resume),this.player.off(t.SEEKED,this.onSeeked),this.player.off(t.LOADING_SHOW,this.pause),this.player.off(t.LOADING_HIDE,this.resume)}},{key:"dispose",value:function(){this.player&&(this.disable(),this.player.Player.__utils.removeNode(this.el),this.player.Player.__utils.dispose(this),this.player=null,this.bulletPool=null,this.aliveBullets=null,this.scrollBullets=null,this.topBullets=null,this.bottomBullets=null,this.items=null,this.el=null,this.opts=null)}}])&&M(e.prototype,n),i&&M(e,i),t}();function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}K.prototype.EVENT=O;var R=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="danmaku-send",this.typeCBs={},this.currentType="scroll",this.onTypeChange=function(t){return function(){e.currentType=t,e.typeCBs.scroll.update(!1),e.typeCBs.top.update(!1),e.typeCBs.bottom.update(!1),e.typeCBs[t].update(!0)}},this.show=function(t){t&&L.getEventPath(t).includes(e.popover.el)||(e.tooltip.hide(),e.popover.show())},this.send=function(){var t=e.inputEl.value;if(t){e.inputEl.value="";var n={text:t,time:e.player.currentTime,type:e.currentType,color:s(t)?void 0:e.colorInputEl.value};e.player.danmaku.send(n)}}}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){var n=this;this.player=t;var i=t.Player,s=i.__utils,o=i.components,d=i.I18n,f=L=s,m=f.$,y=f.addDisposableListener,v=f.addDisposable,k=f.createSvg;this.el=m(".danmaku_send");var b=this.el.appendChild(m());b.appendChild(k("icon","M9.62 14L12 7.67 14.37 14M11 5L5.5 19h2.25l1.12-3h6.25l1.13 3h2.25L13 5h-2z")),this.tooltip=v(this,new o.Tooltip(b,d.t(a))),this.popover=v(this,new o.Popover(b,(function(){return n.tooltip.show()}),void 0,!0)),this.inputEl=this.el.appendChild(m("input")),this.sendEl=this.el.appendChild(m(".danmaku_send_btn",void 0,d.t(r))),this.setPos(e);var g,_=this.popover.panelEl,w=m(".danmaku_row");_.appendChild(w),w.appendChild(m(void 0,void 0,d.t(l))),w=w.appendChild(m(".flex.align-center")),this.typeCBs.scroll=v(this,new o.Checkbox(w,{html:d.t(p),checked:!0,change:this.onTypeChange("scroll")})),this.typeCBs.top=v(this,new o.Checkbox(w,{html:d.t(u),change:this.onTypeChange("top")})),this.typeCBs.bottom=v(this,new o.Checkbox(w,{html:d.t(h),change:this.onTypeChange("bottom")})),w=m(".flex.align-center.danmaku_row"),w=m(".danmaku_row"),_.appendChild(w),w.appendChild(m(void 0,void 0,d.t(c))),w=w.appendChild(m(".danmaku_color_row")),this.colorInputEl=w.appendChild(m("input")),y(this,this.colorInputEl,"input",(function(){n.updateColor(n.colorInputEl.value)})),this.colorEl=w.appendChild(m(".danmaku_color_preview")),y(this,w=m(".danmaku_colors"),"click",(function(t){var e=t.target;e&&e.dataset.value&&n.updateColor(e.dataset.value)})),t.danmaku.opts.colors.forEach((function(t){(g=m(".danmaku_color")).style.background=t,g.dataset.value=t,w.appendChild(g)})),_.appendChild(w),y(this,b,"click",this.show),y(this,this.inputEl,"keypress",(function(t){t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||13===(t.keyCode||t.which)&&n.send()})),y(this,this.inputEl,"focus",(function(){return t.control.require()})),y(this,this.inputEl,"blur",(function(){return t.control.release()})),y(this,this.sendEl,"click",this.send),this.updateColor("#FFFFFF")}},{key:"update",value:function(t){this.setPos(t)}},{key:"setPos",value:function(t){this.popover.resetPos(),2===t&&this.popover.setBottom()}},{key:"updateColor",value:function(t){this.colorInputEl.value=t,this.colorEl.style.background=t,this.inputEl.style.color=t}},{key:"dispose",value:function(){this.player&&(L.dispose(this),L.removeNode(this.el),this.player=null,this.el=null)}}])&&V(e.prototype,n),i&&V(e,i),t}();function Y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var G=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="danmaku-settings",this.show=function(){e.popover.show(),e.tooltip.hide()}}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){var n=this;this.player=t;var i=t.Player,s=i.__utils,o=i.components,a=i.I18n,r=s.$,l=s.clamp,c=s.addDisposableListener,B=s.addDisposable,O=s.createSvg;this.el=r(),this.el.appendChild(O("icon","M9 21v2H7v-2h2m4 0v2h-2v-2h2m4 0v2h-2v-2h2M2 19V3h20v16m-11-7H9v2h2v-2m8 0h-6v2h6v-2M7 8H5v2h2V8m12 0H9v2h10V8z")),this.tooltip=B(this,new o.Tooltip(this.el,a.t(f))),this.popover=B(this,new o.Popover(this.el,(function(){return n.tooltip.show()}))),c(this,this.el,"click",this.show);var A=this.popover.panelEl;s.addClass(A,"danmaku_setting"),this.setPos(e),t.on("Mounted",(function(){var e=function(){return r(".flex.align-center.danmaku_row")},i=e();i.appendChild(r(".danmaku_onoff_label",void 0,a.t(m))),B(n,new o.Switch(i,t.danmaku.enabled,(function(e){return t.danmaku[e?"enable":"disable"]()})));var s=i.appendChild(r(".danmaku_reset",void 0,a.t(y)));c(n,s,"click",(function(){t.danmaku.resetOptions(),n.updateSettings()})),A.appendChild(i),i=r(".danmaku_row"),A.appendChild(i),i.appendChild(r(void 0,void 0,a.t(v))),i=i.appendChild(r(".flex.align-center")),n.scrollCB=B(n,new o.Checkbox(i,{html:a.t(p),change:function(e){t.danmaku[e?"blockType":"allowType"]("scroll")}})),n.topCB=B(n,new o.Checkbox(i,{html:a.t(u),change:function(e){t.danmaku[e?"blockType":"allowType"]("top")}})),n.bottomCB=B(n,new o.Checkbox(i,{html:a.t(h),change:function(e){t.danmaku[e?"blockType":"allowType"]("bottom")}})),n.colorCB=B(n,new o.Checkbox(i,{html:a.t(d),change:function(e){t.danmaku[e?"blockType":"allowType"]("color")}})),(i=e()).appendChild(r(void 0,void 0,a.t(k))),n.opacitySlider=B(n,new o.Slider(i,{stops:[{value:0,html:"10%"},{value:1,html:"100%"}],change:function(e){t.danmaku.updateOpacity(l(e+.1,.1,1))}})),A.appendChild(i),(i=e()).appendChild(r(void 0,void 0,a.t(b))),n.areaSlider=B(n,new o.Slider(i,{stops:[{value:0,html:"1/4"},{value:.33,html:a.t(g)},{value:.66,html:"3/4"},{value:1,html:a.t(_)}],step:!0,change:function(e){e=0===e?.25:.33===e?.5:.66===e?.75:1,t.danmaku.updateArea(e)}})),A.appendChild(i),(i=e()).appendChild(r(void 0,void 0,a.t(w))),n.speedSlider=B(n,new o.Slider(i,{stops:[{value:0,html:a.t(x)},{value:1,html:a.t(C)}],change:function(e){t.danmaku.updateSpeed(l(e+.5,.5,1.5))}})),A.appendChild(i),(i=e()).appendChild(r(void 0,void 0,a.t(S))),n.fontsizeSlider=B(n,new o.Slider(i,{stops:[{value:0,html:a.t(E)},{value:1,html:a.t("Big")}],change:function(e){t.danmaku.updateFontsize(l(e+.5,.5,1.5))}})),A.appendChild(i),i=e(),n.unlimitedCB=B(n,new o.Checkbox(i,{html:a.t(T),change:function(e){t.danmaku.updateUnlimited(e)}})),n.bottomUpCB=B(n,new o.Checkbox(i,{html:a.t(P),change:function(e){t.danmaku.updateBottomUp(e)}})),A.appendChild(i),n.updateSettings()}))}},{key:"update",value:function(t){this.setPos(t)}},{key:"setPos",value:function(t){this.popover.resetPos(),2===t&&this.popover.setBottom()}},{key:"updateSettings",value:function(){var t=this.player.danmaku.opts;this.scrollCB.update(t.blocked.includes("scroll")),this.topCB.update(t.blocked.includes("top")),this.bottomCB.update(t.blocked.includes("bottom")),this.colorCB.update(t.blocked.includes("color")),this.unlimitedCB.update(t.unlimited),this.bottomUpCB.update(t.bottomUp),this.opacitySlider.update(t.opacity),this.areaSlider.update({.25:0,.5:.33,.75:.66,1:1}[t.area]),this.speedSlider.update(t.speed-.5),this.fontsizeSlider.update(t.fontsizeScale-.5)}},{key:"dispose",value:function(){this.player&&(this.player.Player.__utils.dispose(this),this.player.Player.__utils.removeNode(this.el),this.player=null)}}])&&Y(e.prototype,n),i&&Y(e,i),t}();function $(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var J=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opts=e}var e,n,i;return e=t,(n=[{key:"apply",value:function(t){if(t.registerControlItem(new R),t.registerControlItem(new G),t.Player.I18n.add("zh-cn",B),t.danmaku=new K(t,this.opts),!t.mounted&&this.opts&&!1!==this.opts.autoInsert){var e=t.opts.controls[0].findIndex((function(t){return"spacer"===t}));-1!==e&&t.opts.controls[0].splice(e,1,"danmaku-send","danmaku-settings")}}}])&&$(e.prototype,n),i&&$(e,i),t}();J.Plugin=J}(),i=i.default}()}));
//# sourceMappingURL=index.min.js.map