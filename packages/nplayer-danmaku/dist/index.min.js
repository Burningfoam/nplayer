!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("NPlayerDanmaku",[],e):"object"==typeof exports?exports.NPlayerDanmaku=e():t.NPlayerDanmaku=e()}(this,(function(){return function(){var t={498:function(t,e,n){"use strict";n.r(e);var i=n(645),a=n.n(i)()((function(t){return t[1]}));a.push([t.id,".nplayer_danmaku_screen{bottom:0;left:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0}.nplayer_danmaku_send{align-items:center;background:hsla(0,0%,100%,.15);display:flex;flex:1;font-size:0;margin:0 10px!important}.nplayer_danmaku_send input{background:transparent;border:0;color:currentColor;flex:1;outline:0;padding:0;width:100px}.nplayer_danmaku_send input::-moz-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input:-ms-input-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input::placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send_btn{cursor:pointer;font-size:12px;padding:0 10px;white-space:nowrap}.nplayer_danmaku_send .nplayer_popover_panel{padding:0 10px}.nplayer_danmaku_send .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_send .nplayer_checkbox+.nplayer_checkbox{margin-left:8px}.nplayer_danmaku_colors{align-items:center;display:flex;flex-wrap:wrap}.nplayer_danmaku_color{translate:transform .2s ease;height:15px;margin-bottom:5px;margin-right:5px;width:15px}.nplayer_danmaku_color_row{align-items:stretch;display:flex;margin:5px 0}.nplayer_danmaku_color_row input{border:1px solid hsla(0,0%,100%,.8);flex:3;letter-spacing:1px;padding:0 5px;width:0}.nplayer_danmaku_color_preview{flex:2;height:20px;margin-left:5px}.nplayer_danmaku_color:hover{transform:scale(1.1)}.nplayer_danmaku_row{justify-content:space-between;margin:8px 0}.nplayer_danmaku_onoff_label{margin-right:5px;margin-top:-2px}.nplayer_danmaku_reset{border:1px solid hsla(0,0%,100%,.5);margin-left:auto;padding:2px 5px;transition:opacity .2s ease}.nplayer_danmaku_reset:hover{opacity:.7}.nplayer_danmaku_setting{padding:6px 8px}.nplayer_danmaku_setting .nplayer_slider{margin:3px 10px}.nplayer_danmaku_setting .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_setting .nplayer_checkbox+.nplayer_checkbox{margin-left:8px}.nplayer_danmaku_item{color:#fff;letter-spacing:1px;line-height:1.125;position:absolute;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px;white-space:nowrap;will-change:transform}.nplayer_danmaku_item-center{left:50%;transform:translateX(-50%);will-change:auto;z-index:1}.nplayer_danmaku_item-me{outline:2px solid;z-index:2}",""]),e.default=a},645:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(i)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(a[o]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);i&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},132:function(t,e,n){var i;"undefined"!=typeof window&&window.document&&function(){var t=n(498);t.__esModule&&(t=t.default);var e="string"==typeof t?t:t[0][1],a=!1;i||((i=document.createElement("style")).setAttribute("type","text/css"),a=!0),"textContent"in i?i.textContent=e:i.styleSheet.cssText=e,a&&document.head.appendChild(i)}()}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return function(){"use strict";n.d(i,{default:function(){return W}});var t;n(132);function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){return!t||("#fff"===(t=t.toLowerCase())||"#ffffff"===t)}var s={_prevPauseTime:0,_pausedTime:0,_paused:!1,now:function(){return((this._paused?this._prevPauseTime:Date.now())-this._pausedTime)/1e3},play:function(){this._paused&&(this._pausedTime+=Date.now()-this._prevPauseTime,this._paused=!1)},pause:function(){this._paused||(this._prevPauseTime=Date.now(),this._paused=!0)}},o="nplayer:danmaku";var r="Send settings",l="Send",p="Mode",u="Scroll",h="Top",c="Bottom",d="Color",f="Color",m="Danmaku settings",y="On/Off",v="Restore settings",k="Block by type",b="Opacity &nbsp;",g="Area &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",_="Half",w="Full",x="Speed &nbsp;&nbsp;&nbsp;",C="Slow",S="Fast",E="Font size",T="Small",O="Unlimited",B="Bottom to top",A=(e(t={},r,"发送设置"),e(t,l,"发送"),e(t,p,"模式"),e(t,u,"滚动"),e(t,h,"顶部"),e(t,c,"底部"),e(t,d,"颜色"),e(t,f,"彩色"),e(t,m,"弹幕设置"),e(t,y,"开/关"),e(t,v,"恢复默认设置"),e(t,k,"按类型屏蔽"),e(t,b,"不透明度"),e(t,g,"显示区域"),e(t,_,"半屏"),e(t,w,"全屏"),e(t,x,"弹幕速度"),e(t,C,"慢"),e(t,S,"快"),e(t,E,"字体大小"),e(t,T,"小"),e(t,"Big","大"),e(t,O,"不限弹幕"),e(t,B,"从下到上"),t),P={DANMAKU_SEND:"DanmakuSend",DANMAKU_UPDATE_OPTIONS:"DanmakuUpdateOptions"};function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I="nplayer_danmaku_item",F=function(){function t(e,n,i,a){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.danmaku=n,this.width=0,this.left=0,this.length=0,this.startAt=0,this.showAt=0,this.endAt=0,this.speed=0,this.track=0,this.ended=!1,this.color="",this.end=function(){s.element.removeEventListener("transitionend",s.end),clearTimeout(s.centerTimer),s.element.style.cssText="",s.color="",s.element.className=I,s.ended=!0,s.hide(),s.danmaku.recycleBullet(s)},this.element=e.appendChild(document.createElement("div")),this.element.className=I,this.init(i,a)}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){this.element.textContent=t.text,this.type=t.type||"scroll",this.track=e.track,t.color&&(this.element.style.color=this.color=t.color),t.isMe&&this.element.classList.add("nplayer_danmaku_item-me");var n=this.element.style;if(n.fontSize="".concat(this.danmaku.fontsize,"px"),this.startAt=s.now(),"scroll"===this.type){this.element.addEventListener("transitionend",this.end),this.width=this.element.getBoundingClientRect().width+20;var i=this.danmaku.width,a=e.prev;if(this.left=i,this.speed=this.danmaku.speedScale*(i+this.width)/this.danmaku.opts.duration,a&&!a.ended){var o=a.length-i-(this.startAt-a.startAt)*a.speed;if(o>=0)this.speed=a.speed,this.left+=o;else{var r=this.danmaku.width/(a.endAt-this.startAt);this.speed>r&&(this.speed=r)}}this.length=this.left+this.width;var l=this.length/this.speed;this.showAt=this.startAt+(this.length-i)/this.speed,this.endAt=this.startAt+l,this.updateScrollY(),n.left="".concat(this.left,"px"),n.transition="transform ".concat(l,"s linear"),n.transform="translate3d(-".concat(this.length,"px,0,0)")}else{n[this.type]=this.pos(),this.element.classList.add("nplayer_danmaku_item-center");var p=this.danmaku.speedScale*this.danmaku.opts.duration;this.endAt=this.startAt+p,this.centerTimer=setTimeout(this.end,1e3*p)}return this.ended=!1,this.show(),this.danmaku.paused&&this.pause(this.startAt),this}},{key:"pos",value:function(){return"".concat(this.track*this.danmaku.trackHeight+2,"px")}},{key:"updateScrollY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.danmaku.opts.bottomUp;if("scroll"===this.type){var e=this.element.style;e.top=e.bottom="",e[t?"bottom":"top"]=this.pos()}}},{key:"show",value:function(){this.element.style.visibility="visible"}},{key:"hide",value:function(){this.element.style.visibility="hidden"}},{key:"pause",value:function(t){if("scroll"===this.type){var e=this.element.style;e.transition="transform 0s linear",e.transform="translate3d(-".concat((t-this.startAt)*this.speed,"px,0,0)")}else clearTimeout(this.centerTimer)}},{key:"run",value:function(t){if("scroll"===this.type){var e=this.element.style;e.transition="transform ".concat(this.endAt-t,"s linear"),e.transform="translate3d(-".concat(this.length,"px,0,0)")}else this.centerTimer=setTimeout(this.end,1e3*(this.endAt-t))}}])&&D(e.prototype,n),i&&D(e,i),t}();function j(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==n)return;var i,a,s=[],o=!0,r=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){r=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(r)throw a}}return s}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var H,K=function(){return{disable:!1,blocked:[],fontsize:24,fontsizeScale:1,opacity:1,speed:1,area:.5,unlimited:!1,bottomUp:!1,colors:["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"],duration:5,items:[],zIndex:5,persistOptions:!1,isDefaultColor:a,discard:function(){return!1}}},V=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e,this._opts=n,this.enabled=!1,this.paused=!1,this.track=0,this.trackHeight=0,this.bulletPool=[],this.aliveBullets=new Set,this.scrollBullets=[],this.topBullets=[],this.bottomBullets=[],this.items=[],this.pos=0,this.prevPauseTime=0,this.fire=function(){if(i.enabled&&i.player.playing){i.paused&&i.resume();for(var t,e=i.currentTime,n=i.opts.unlimited?.5:1,a=e-n,o=e+n,r=s.now(),l=i.items.length;i.pos<l;i.pos++)if(!((t=i.items[i.pos]).time<a)){if(t.time>o)break;if(!i.shouldDiscard(t)&&!i.insert(t,r))break}}},this.onSeeked=function(){i.clearScreen(),i.pos=0},this.pause=function(){i.prevPauseTime=s.now(),s.pause(),i.aliveBullets.forEach((function(t){return t.pause(i.prevPauseTime)})),i.paused=!0},this.resume=function(){i.player.playing&&!i.player.loading.isActive&&(s.play(),i.aliveBullets.forEach((function(t){return t.run(i.prevPauseTime)})),i.paused=!1)},this.opts=U(U(U({},K()),function(){try{var t=window.localStorage.getItem(o);if(!t)return;return JSON.parse(t)}catch(t){}}()),n);var a=e.Player._utils,r=a.$,l=a.addDisposable;this.element=e.element.appendChild(r(".danmaku_screen")),this.element.style.zIndex=String(this.opts.zIndex),this.items=this.opts.items,this.opts.disable||this.enable(),l(this,e.on(e.EVENT.MOUNTED,(function(){i.updateTrack()}))),l(e,this)}var e,n,i;return e=t,(n=[{key:"width",get:function(){return this.player.rect.width}},{key:"currentTime",get:function(){return this.player.currentTime}},{key:"playbackRate",get:function(){return this.player.playbackRate}},{key:"fontsize",get:function(){return this.opts.fontsize*this.opts.fontsizeScale}},{key:"speedScale",get:function(){return this.playbackRate*this.opts.speed}},{key:"createBullet",value:function(t,e){var n=this.bulletPool.pop();return n?n.init(t,e):n=new F(this.element,this,t,e),this.aliveBullets.add(n),n}},{key:"getShortestTrack",value:function(){var t=this.scrollBullets[0];if(!t||t.ended)return[0];for(var e,n=1;n<this.track;++n){if(!(e=this.scrollBullets[n])||e.ended)return[n];t.showAt>e.showAt&&(t=e)}return[t.track,t]}},{key:"getEmptyTrack",value:function(t,e){for(var n=0;n<this.track;++n)if(!e[n]||e[n]<=t)return n;return-1}},{key:"shouldDiscard",value:function(t){return!(!this.opts.blocked.includes(t.type||"scroll")&&!this.opts.discard(t)&&(!t.color||!this.opts.blocked.includes("color")||this.opts.isDefaultColor(t.color)))}},{key:"updateTrack",value:function(){this.trackHeight=this.fontsize+5,this.track=Math.floor(this.player.rect.height*this.opts.area/this.trackHeight)}},{key:"storeOptions",value:function(){if(this.player.emit(P.DANMAKU_UPDATE_OPTIONS,this.opts),this.opts.persistOptions){var t=this.opts;!function(t){try{window.localStorage.setItem(o,JSON.stringify(t))}catch(t){}}({blocked:t.blocked,fontsizeScale:t.fontsizeScale,opacity:t.opacity,speed:t.speed,area:t.area,unlimited:t.unlimited,bottomUp:t.bottomUp})}}},{key:"recycleBullet",value:function(t){this.bulletPool.push(t),this.aliveBullets.delete(t),"scroll"===t.type&&this.scrollBullets[t.track]===t&&(this.scrollBullets[t.track]=void 0)}},{key:"insert",value:function(t,e){if(!t.type||"scroll"===t.type){var n=j(this.getShortestTrack(),2),i=n[0],a=n[1],s=!t.force&&a&&a.showAt>e+2;return!(s&&!this.opts.unlimited||(this.scrollBullets[i]=this.createBullet(t,{track:i,prev:s?void 0:a}),0))}var o="top"===t.type?this.topBullets:this.bottomBullets,r=this.getEmptyTrack(e,o);return-1!==(r=-1===r&&t.force?0:r)&&(o[r]=this.createBullet(t,{track:r}).endAt,!0)}},{key:"send",value:function(t){null==t.time&&(t.time=this.currentTime),t=U({isMe:!0,force:!0},t),this.player.emit(P.DANMAKU_SEND,t);var e=this.addItem(t);this.pos>e&&this.insert(t,s.now())}},{key:"getItems",value:function(){return this.items}},{key:"addItem",value:function(t){if(null==t.time)return-1;for(var e=0,n=0,i=this.items.length;n<i;n++)if(this.items[n].time>t.time){e=n;break}return this.items.splice(e,0,t),e}},{key:"appendItems",value:function(t){this.items=this.items.concat(t)}},{key:"resetItems",value:function(t){this.items=t,this.pos=0}},{key:"updateOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.opts.opacity;this.element.style.opacity=String(t),this.storeOptions()}},{key:"updateFontsize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.opts.fontsizeScale;this.opts.fontsizeScale=t,this.updateTrack(),this.storeOptions()}},{key:"updateArea",value:function(t){[.25,.5,.75,1].includes(t)&&(this.opts.area=t,this.updateTrack(),this.storeOptions())}},{key:"updateUnlimited",value:function(t){this.opts.unlimited=t,this.storeOptions()}},{key:"updateBottomUp",value:function(t){this.opts.bottomUp=t,this.aliveBullets.forEach((function(e){return e.updateScrollY(t)})),this.storeOptions()}},{key:"updateSpeed",value:function(t){this.opts.speed=t,this.storeOptions()}},{key:"blockType",value:function(t){var e=this;this.opts.blocked.includes(t)||(this.opts.blocked.push(t),this.aliveBullets.forEach((function(n){(n.type===t||"color"===t&&!e.opts.isDefaultColor(n.color))&&n.hide()})),this.storeOptions())}},{key:"allowType",value:function(t){var e=this;this.opts.blocked=this.opts.blocked.filter((function(e){return e!==t})),this.aliveBullets.forEach((function(n){(n.type===t||"color"===t&&!e.opts.isDefaultColor(n.color))&&n.show()})),this.storeOptions()}},{key:"resetOptions",value:function(){var t=this;this.opts.blocked.forEach((function(e){t.allowType(e)})),this.opts=U(U({},K()),this._opts),this.opts.blocked=[],this.updateOpacity(),this.updateFontsize(),this.updateBottomUp(this.opts.bottomUp)}},{key:"clearScreen",value:function(){Array.from(this.aliveBullets).forEach((function(t){return t.end()})),this.topBullets=[],this.bottomBullets=[]}},{key:"enable",value:function(){if(!this.enabled){this.enabled=!0;var t=this.player.EVENT;this.player.on(t.TIME_UPDATE,this.fire),this.player.on(t.PAUSE,this.pause),this.player.on(t.ENDED,this.pause),this.player.on(t.PLAY,this.resume),this.player.on(t.SEEKED,this.onSeeked),this.player.on(t.LOADING_SHOW,this.pause),this.player.on(t.LOADING_HIDE,this.resume)}}},{key:"disable",value:function(){this.enabled=!1,this.clearScreen();var t=this.player.EVENT;this.player.off(t.TIME_UPDATE,this.fire),this.player.off(t.PAUSE,this.pause),this.player.off(t.ENDED,this.pause),this.player.off(t.PLAY,this.resume),this.player.off(t.SEEKED,this.onSeeked),this.player.off(t.LOADING_SHOW,this.pause),this.player.off(t.LOADING_HIDE,this.resume)}},{key:"dispose",value:function(){this.player&&(this.disable(),this.player.Player._utils.removeNode(this.element),this.player.Player._utils.dispose(this),this.player=null,this.bulletPool=null,this.aliveBullets=null,this.scrollBullets=null,this.topBullets=null,this.bottomBullets=null,this.items=null,this.element=null,this.opts=null)}}])&&L(e.prototype,n),i&&L(e,i),t}();function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}V.prototype.EVENT=P;var Y=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="danmaku-send",this.typeCBs={},this.currentType="scroll",this.onTypeChange=function(t){return function(){e.currentType=t,e.typeCBs.scroll.update(!1),e.typeCBs.top.update(!1),e.typeCBs.bottom.update(!1),e.typeCBs[t].update(!0)}},this.show=function(t){t&&H.getEventPath(t).includes(e.popover.element)||(e.tooltip.hide(),e.popover.show())},this.send=function(){var t=e.inputElement.value;if(t){e.inputElement.value="";var n={text:t,time:e.player.currentTime,type:e.currentType,color:a(t)?void 0:e.colorInputElement.value};e.player.danmaku.send(n)}}}var e,n,i;return e=t,(n=[{key:"init",value:function(t){var e=this;this.player=t;var n=t.Player,i=n._utils,a=n.components,s=n.I18n,o=H=i,f=o.$,m=o.addDisposableListener,y=o.addDisposable,v=o.createSvg;this.element=f(".danmaku_send");var k=this.element.appendChild(f());k.appendChild(v("icon","M9.62 14L12 7.67 14.37 14M11 5L5.5 19h2.25l1.12-3h6.25l1.13 3h2.25L13 5h-2z")),this.tooltip=y(this,new a.Tooltip(k,s.t(r))),this.popover=y(this,new a.Popover(k,void 0,void 0,!0)),this.inputElement=this.element.appendChild(f("input")),this.sendElement=this.element.appendChild(f(".danmaku_send_btn",void 0,s.t(l)));var b,g=this.popover.panelElement,_=f(".danmaku_row");g.appendChild(_),_.appendChild(f(void 0,void 0,s.t(p))),_=_.appendChild(f(".flex.align-center")),this.typeCBs.scroll=y(this,new a.Checkbox(_,{html:s.t(u),checked:!0,change:this.onTypeChange("scroll")})),this.typeCBs.top=y(this,new a.Checkbox(_,{html:s.t(h),change:this.onTypeChange("top")})),this.typeCBs.bottom=y(this,new a.Checkbox(_,{html:s.t(c),change:this.onTypeChange("bottom")})),_=f(".flex.align-center.danmaku_row"),_=f(".danmaku_row"),g.appendChild(_),_.appendChild(f(void 0,void 0,s.t(d))),_=_.appendChild(f(".danmaku_color_row")),this.colorInputElement=_.appendChild(f("input")),m(this,this.colorInputElement,"input",(function(){e.updateColor(e.colorInputElement.value)})),this.colorElement=_.appendChild(f(".danmaku_color_preview")),m(this,_=f(".danmaku_colors"),"click",(function(t){var n=t.target;n&&n.dataset.value&&e.updateColor(n.dataset.value)})),t.danmaku.opts.colors.forEach((function(t){(b=f(".danmaku_color")).style.background=t,b.dataset.value=t,_.appendChild(b)})),g.appendChild(_),m(this,k,"click",this.show),m(this,this.inputElement,"keypress",(function(t){t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||13===(t.keyCode||t.which)&&e.send()})),m(this,this.inputElement,"focus",(function(){return t.control.require()})),m(this,this.inputElement,"blur",(function(){return t.control.release()})),m(this,this.sendElement,"click",this.send),this.updateColor("#FFFFFF")}},{key:"updateColor",value:function(t){this.colorInputElement.value=t,this.colorElement.style.background=t,this.inputElement.style.color=t}},{key:"dispose",value:function(){this.player&&(H.dispose(this),H.removeNode(this.element),this.player=null,this.element=null)}}])&&R(e.prototype,n),i&&R(e,i),t}();function G(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var $=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="danmaku-setting",this.show=function(){e.popover.show(),e.tooltip.hide()}}var e,n,i;return e=t,(n=[{key:"init",value:function(t){var e=this;this.player=t;var n=t.Player,i=n._utils,a=n.components,s=n.I18n,o=i.$,r=i.clamp,l=i.addDisposableListener,p=i.addDisposable,d=i.createSvg;this.element=o(),this.element.appendChild(d("icon","M9 21v2H7v-2h2m4 0v2h-2v-2h2m4 0v2h-2v-2h2M2 19V3h20v16m-11-7H9v2h2v-2m8 0h-6v2h6v-2M7 8H5v2h2V8m12 0H9v2h10V8z")),this.tooltip=p(this,new a.Tooltip(this.element,s.t(m))),this.popover=p(this,new a.Popover(this.element)),l(this,this.element,"click",this.show);var A=this.popover.panelElement;i.addClass(A,"danmaku_setting"),t.on("Mounted",(function(){var n=function(){return o(".flex.align-center.danmaku_row")},i=n();i.appendChild(o(".danmaku_onoff_label",void 0,s.t(y))),p(e,new a.Switch(i,t.danmaku.enabled,(function(e){return t.danmaku[e?"enable":"disable"]()})));var d=i.appendChild(o(".danmaku_reset",void 0,s.t(v)));l(e,d,"click",(function(){t.danmaku.resetOptions(),e.update()})),A.appendChild(i),i=o(".danmaku_row"),A.appendChild(i),i.appendChild(o(void 0,void 0,s.t(k))),i=i.appendChild(o(".flex.align-center")),e.scrollCB=p(e,new a.Checkbox(i,{html:s.t(u),change:function(e){t.danmaku[e?"blockType":"allowType"]("scroll")}})),e.topCB=p(e,new a.Checkbox(i,{html:s.t(h),change:function(e){t.danmaku[e?"blockType":"allowType"]("top")}})),e.bottomCB=p(e,new a.Checkbox(i,{html:s.t(c),change:function(e){t.danmaku[e?"blockType":"allowType"]("bottom")}})),e.colorCB=p(e,new a.Checkbox(i,{html:s.t(f),change:function(e){t.danmaku[e?"blockType":"allowType"]("color")}})),(i=n()).appendChild(o(void 0,void 0,s.t(b))),e.opacitySlider=p(e,new a.Slider(i,{stops:[{value:0,html:"10%"},{value:1,html:"100%"}],change:function(e){t.danmaku.updateOpacity(r(e+.1,.1,1))}},t)),A.appendChild(i),(i=n()).appendChild(o(void 0,void 0,s.t(g))),e.areaSlider=p(e,new a.Slider(i,{stops:[{value:0,html:"1/4"},{value:.33,html:s.t(_)},{value:.66,html:"3/4"},{value:1,html:s.t(w)}],step:!0,change:function(e){e=0===e?.25:.33===e?.5:.66===e?.75:1,t.danmaku.updateArea(e)}},t)),A.appendChild(i),(i=n()).appendChild(o(void 0,void 0,s.t(x))),e.speedSlider=p(e,new a.Slider(i,{stops:[{value:0,html:s.t(C)},{value:1,html:s.t(S)}],change:function(e){t.danmaku.updateSpeed(r(e+.5,.5,1.5))}},t)),A.appendChild(i),(i=n()).appendChild(o(void 0,void 0,s.t(E))),e.fontsizeSlider=p(e,new a.Slider(i,{stops:[{value:0,html:s.t(T)},{value:1,html:s.t("Big")}],change:function(e){t.danmaku.updateFontsize(r(e+.5,.5,1.5))}},t)),A.appendChild(i),i=n(),e.unlimitedCB=p(e,new a.Checkbox(i,{html:s.t(O),change:function(e){t.danmaku.updateUnlimited(e)}})),e.bottomUpCB=p(e,new a.Checkbox(i,{html:s.t(B),change:function(e){t.danmaku.updateBottomUp(e)}})),A.appendChild(i),e.update()}))}},{key:"update",value:function(){var t=this.player.danmaku.opts;this.scrollCB.update(t.blocked.includes("scroll")),this.topCB.update(t.blocked.includes("top")),this.bottomCB.update(t.blocked.includes("bottom")),this.colorCB.update(t.blocked.includes("color")),this.unlimitedCB.update(t.unlimited),this.bottomUpCB.update(t.bottomUp),this.opacitySlider.update(t.opacity),this.areaSlider.update({.25:0,.5:.33,.75:.66,1:1}[t.area]),this.speedSlider.update(t.speed-.5),this.fontsizeSlider.update(t.fontsizeScale-.5)}},{key:"dispose",value:function(){this.player&&(this.player.Player._utils.dispose(this),this.player.Player._utils.removeNode(this.element),this.player=null)}}])&&G(e.prototype,n),i&&G(e,i),t}();function J(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var W=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opts=e}var e,n,i;return e=t,(n=[{key:"apply",value:function(t){if(t.registerControlItem(new Y),t.registerControlItem(new $),t.Player.I18n.add("zh-cn",A),t.danmaku=new V(t,this.opts),this.opts&&!1!==this.opts.autoInsertControl){var e=t.opts.controls.findIndex((function(t){return"spacer"===t}));if(e>-1){t.opts.controls.splice(e+1,0,"danmaku-send","danmaku-setting");var n=t.getControlItem("spacer");n&&n.flex(0)}else t.opts.controls.push("danmaku-send","danmaku-setting")}}}])&&J(e.prototype,n),i&&J(e,i),t}();W.Plugin=W}(),i=i.default}()}));
//# sourceMappingURL=index.min.js.map